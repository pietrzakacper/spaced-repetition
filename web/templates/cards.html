<html>
  <head>
    <link rel="stylesheet" href="/static/satoshi.css" />
    <link rel="stylesheet" href="/static/main.css" />
  </head>
  <body>
    <div class="main-container">
      <div class="main-content">
        <header>
          <div class="logo">Spaced Repetition</div>
        </header>
        <main>
          <div class="cards">
            <div class="all-cards-container">
              {{ range .Cards }}
              <div id="small-card-container">
                <div class="small-card" id="small-card">
                  <div class="small-card-front bg-{{ .Kind }}">
                    {{ .Front }}
                  </div>
                  <div class="small-card-back bg-{{ .Kind }}">{{ .Back }}</div>
                </div>
                <div class="small-card hidden" id="small-card-edit-form">
                  <div class="small-card-front bg-{{ .Kind }}">
                    <form
                      class="edit-card-container"
                      action="/edit-card?id={{ .Id }}"
                      method="POST"
                      id="edit-form"
                    >
                      <input
                        class="edit-card-text-input"
                        type="text"
                        name="Front"
                        value="{{ .Front }}"
                        placeholder="Front..."
                        autocomplete="off"
                      />
                      <input
                        class="edit-card-text-input"
                        type="text"
                        name="Back"
                        value="{{ .Back }}"
                        placeholder="Back..."
                        autocomplete="off"
                      />
                    </form>
                  </div>
                </div>
                <div class="edit-buttons-container" id="edit-buttons-container">
                  <button class="edit-button" id="edit-button">
                    <img src="/static/edit.svg" />
                  </button>
                  <form
                    method="POST"
                    action="/delete-card?id={{ .Id }}"
                    id="delete-form"
                  >
                    <button class="edit-button">
                      <img src="/static/delete.svg" />
                    </button>
                  </form>
                </div>
                <div
                  class="edit-buttons-container hidden"
                  id="edit-actions-container"
                >
                  <button class="edit-button" id="cancel-button">
                    <img src="/static/close.svg" />
                  </button>

                  <button class="edit-button" id="approve-button">
                    <img src="/static/check.svg" />
                  </button>
                </div>
              </div>
              {{ end }}
            </div>
          </div>
        </main>
      </div>
    </div>
    <script>
      const $cards = document.querySelectorAll("#small-card-container");

      Array.from($cards).forEach(($card) => {
        $card
          .querySelector("#edit-button")
          .addEventListener("click", (event) => {
            event.preventDefault();
            $card.querySelector("#small-card").classList.add("hidden");
            $card
              .querySelector("#edit-buttons-container")
              .classList.add("hidden");

            $card
              .querySelector("#edit-actions-container")
              .classList.remove("hidden");
            $card
              .querySelector("#small-card-edit-form")
              .classList.remove("hidden");

            $card
              .querySelector("#approve-button")
              .addEventListener("click", () => {
                $card.querySelector("form").submit();
              });
          });
      });
    </script>
  </body>
</html>
