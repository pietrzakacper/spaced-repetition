<html>
  <head>
    <link rel="stylesheet" href="/static/satoshi.css" />
    <link rel="stylesheet" href="/static/main-v1.0.2.css" />
    <link rel="icon" href="/static/favicon.ico"/>
    <meta name="viewport" content="width=device-width initial-scale=1">
    <title>spaced repetition</title>
  </head>
  <body>
    <div class="main-container">
      <div class="main-content">
        <header class="top">
          <a href="/" class="logo">Spaced Repetition</a>
        </header>
        <main class="home-main">
          <div class="memorize">
             {{if and (ne .AllCardsCount 0) (eq .DueToReviewCount 0) (eq .NewCardsCount 0)}}
             <section class="all-memorized-msg">You've memorized all your cards ü•≥ <br/> Come back tomorrow to review them üôè</section>
              {{end}}
            <section class="memorize-section box  {{if and (ne .AllCardsCount 0) (eq .DueToReviewCount 0) (eq .NewCardsCount 0)}}inactive{{end}}">
              <form action="/review" method="POST">
                <div class="memorize-column">
                  <span><b>Cards to review</b>: {{ .DueToReviewCount }}</span>
                  <input
                    {{if eq .DueToReviewCount 0}}disabled{{end}}
                    class="button"
                    type="submit"
                    value="review"
                   />
                </div>
              </form>
              <form action="/learnNew" method="POST">
                <div class="memorize-column">
                  <span><b>New cards</b>: {{ .NewCardsCount }}</span>
                    <input
                      {{if eq .NewCardsCount 0}}disabled{{end}}
                      class="button secondary {{ if and (ne .AllCardsCount 0) (eq .AllCardsCount .NewCardsCount) }}glow-animation{{end}}"
                      type="submit"
                      value="memorize"
                    />
                </div>
              </form>
            </section>
          <section class="memorize-section-mobile box {{if and (ne .AllCardsCount 0) (eq .DueToReviewCount 0) (eq .NewCardsCount 0)}}inactive{{end}}">
              <form action="/review" method="POST">
                <div class="memorize-column">
                  <input
                    {{if eq .DueToReviewCount 0}}disabled{{end}}
                    class="button"
                    type="submit"
                    value="review ({{ .DueToReviewCount }})"
                   />
                </div>
              </form>
              <form action="/learnNew" method="POST">
                <div class="memorize-column">
                    <input
                      {{if eq .NewCardsCount 0}}disabled{{end}}
                      class="button secondary {{ if and (ne .AllCardsCount 0) (eq .AllCardsCount .NewCardsCount) }}glow-animation{{end}}"
                      type="submit"
                      value="memorize ({{ .NewCardsCount }})"
                    />
                </div>
              </form>
            </section>
   
          </div>
          <div class="cards">
              <div class="cards-header">
                <h3 class="cards-header-main">Recently added</h3>
                <a href="/cards" class="show-all-cards-btn">Show all cards ({{.AllCardsCount}})</a>
              </div>
              <div class="recent-cards-container">
              {{ range .Cards }}
                  <div class="small-card">
                        <div class="small-card-front bg-{{ .Kind }}">{{ .Front }}</div>
                        <div class="small-card-back bg-{{ .Kind }}">{{ .Back }}</div>
                  </div>
              {{ end }}
              </div> 
          </div>

          <div class="tools">
            <section>
              <label class="tool-label  {{ if eq .AllCardsCount 0 }}glow-animation{{end}}">Add single card</label>
              <form action="/add" method="POST">
                <div class="add-container">
                  <div>
                    <input
                      class="text-input"
                      type="text"
                      name="front"
                      placeholder="front..."
                      autocomplete="off"
                    />
                    <input
                      class="text-input"
                      type="text"
                      name="back"
                      placeholder="back..."
                      autocomplete="off"
                    />
                  </div>
                  <input class="button accent2" type="submit" value="add" />
                </div>
              </form>
            </section>

            <section class="import-tool-section">
                <label class="tool-label import-label">Import cards from CSV
                  <span class="import-instruction">columns should be (front, back)</span>
                </label>
                <form action="/import" method="POST" enctype="multipart/form-data">
                  <div class="add-container">
                    <div class='file-input'>
                      <input class="button" type="file" name="fileToUpload" id="fileToUpload" />
                      <span class='button'>Choose</span>
                      <span class='label' data-js-label>No file selected</label>
                    </div>
                    <input class="button accent2" type="submit" value="import"/>
                  </div>
                </form>
                <script>
                  var inputs = document.querySelectorAll('.file-input')

                  for (var i = 0, len = inputs.length; i < len; i++) {
                  customInput(inputs[i])
                  }

                  function customInput (el) {
                  const fileInput = el.querySelector('[type="file"]')
                  const label = el.querySelector('[data-js-label]')
                  
                  fileInput.onchange =
                  fileInput.onmouseout = function () {
                    if (!fileInput.value) return
                    
                    var value = fileInput.value.replace(/^.*[\\\/]/, '')
                    el.className += ' -chosen'
                    label.innerText = value
                  }
                  }
                </script>
            </section>
          </div>
        </main>
        </div>
      </div>
      <script>
        // autorefresh every 8h
        setInterval(() => window.location.reload(), 8 * 60 * 60 * 1000)
      </script>
  </body>
</html>
